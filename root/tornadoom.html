<!DOCTYPE html>
<html>
<head>
    <title>Tornadoom</title>
    <link rel="stylesheet" type="text/css" href="vonDoomStyles.css" />
    <!---------- Engine scripts  ---------->
    <script type="text/javascript" src="engine/scripts/math/mathUtils.js"></script>
    <script type="text/javascript" src="engine/scripts/math/vectors.js"></script>
    <script type="text/javascript" src="engine/scripts/math/quaternion.js"></script>
    <script type="text/javascript" src="engine/scripts/math/matrices.js"></script>
    <script type="text/javascript" src="engine/scripts/math/geometry.js"></script>
    <script type="text/javascript" src="engine/scripts/structsEnumsConsts.js"></script>
    <script type="text/javascript" src="engine/scripts/transform.js"></script>
    <script type="text/javascript" src="engine/scripts/utility.js"></script>
    <script type="text/javascript" src="engine/scripts/primitiveShapes.js"></script>
    <script type="text/javascript" src="engine/scripts/camera.js"></script>
    <script type="text/javascript" src="engine/scripts/gameObject.js"></script>
    <script type="text/javascript" src="engine/scripts/inGameGUI.js"></script>
    <script type="text/javascript" src="engine/scripts/glControl.js"></script>
    <script type="text/javascript" src="engine/scripts/engineManager.js"></script>
    <script type="text/javascript" src="engine/scripts/gameManager.js"></script>
    <script type="text/javascript" src="engine/scripts/tdControl.js"></script>
    <script type="text/javascript" src="engine/scripts/modelControl.js"></script>
    <script type="text/javascript" src="engine/scripts/physicsControl.js"></script>
    <script type="text/javascript" src="engine/scripts/collisionControl.js"></script>
    <script type="text/javascript" src="engine/scripts/input.js"></script>
    <!---------- Game scripts  ---------->
    <script type="text/javascript" src="game/scripts/screens.js"></script>
</head>
<body onload="EM.PreLoad(main)">
    <canvas id="canvasWebGL" width="1500" height="800"></canvas>
    <canvas id="canvas2D" width="1500" height="800"></canvas>
    <script id="main">
        /* Entry point for engine user.
        * This function must be called by
        * the body's onload function within
        * EM.PreLoad(). */
        function main() {

            function Initialize() {
                var textureNamesFilepaths = [
                    ['discSurface', 'game/assets/images/discSurface.png']
                ];

                var modelNamesFilepaths = [
                    ['disc', 'game/assets/models/GameObjects_Disc.json']
                ];

                GM.LoadExternal(textureNamesFilepaths, modelNamesFilepaths, Run);
            }

            function Run() {
                var activeScreen;
                function SetScreen(newScreen) {
                    activeScreen = newScreen;
                }
                /* Pass in SetScreen as a callback so the screen can be changed
                 as much as needed in the screens script. */
                activeScreen = new Screen_Title(SetScreen)

                var time_LastFrame;
                function LoopGame() {
                    requestAnimationFrame(LoopGame);
                    var time_ThisFrame = new Date().getTime();
                    var time_Delta = time_ThisFrame - (time_LastFrame || time_ThisFrame);
                    time_LastFrame = time_ThisFrame;
                    Time.delta_Milli = time_Delta / 1000;
                    Time.fps = 1000 / time_Delta;
                    activeScreen.Update(Time.delta_Milli);
                    // Updating Game World and Draw Calls
                    GM.Update();
                    GL.RenderScene();
                }
                LoopGame();
            }

            Initialize();

            /*
            var tornadoom = new Game();
            tornadoom.LoadAssets(textureNamesFilepaths, modelNamesFilepaths);
            tornadoom.AddScreen('title', Screen_Title);
            tornadoom.AddScreen('in game', Screen_InGame);
            tornadoom.AddScreen('game over', Screen_GameOver);
            tornadoom.SetScreen('title');
            tornadoom.Run();
            */
        }
    </script>
</body>
</html>